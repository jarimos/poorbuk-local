function PsModalComments(){this.current_object=null;this.objects={}}var ps_comments=new PsModalComments;PsModalComments.prototype.init=function(){peepso.observer.addAction("peepso_delete_post",function(postId){peepso.lightbox("close")},10,1)};PsModalComments.prototype.open=function(object_id,type,options,params){var _self=this;var req=jQuery.extend({object_id:object_id,type:type},params||{});peepso.lightbox(function(callback){$PeepSo.disableAuth().postJson("modalcomments.get_object",req,function(response){var data=[];options=options||{};if(response.success){data=response.data.objects;options=jQuery.extend({index:response.data.index,afterchange:function(lightbox){jQuery(document).trigger("peepso_tags_init_comments");activity.setup_comment_textarea();ps_observer.apply_filters("modalcomments.afterchange",lightbox);if(lightbox.$attachment){lightbox.$attachment.find(".ps-stream-attachment, .ps-comment-item").each(function(item){var $post=jQuery(this),html=$post.html();html=peepso.observer.applyFilters("peepso_activity_content",html);$post.html(html)})}}},options)}callback(data,options)})});return false};PsModalComments.prototype.next=function(){this.save_object()};PsModalComments.prototype.prev=function(){this.save_object()};PsModalComments.prototype.save_object=function(){if(undefined!==this.current_object)this.objects[this.current_object.ID]=this.current_object};jQuery(document).ready(function(){ps_comments.init()});