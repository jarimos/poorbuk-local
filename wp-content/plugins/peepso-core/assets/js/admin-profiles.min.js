!function(t){var e,s=t(".ps-js-fields-container");s.on("input",".ps-js-field input[type=text]",function(){t(this).closest(".ps-js-fieldconf").find(".ps-js-btn").show()}).on("keydown",".ps-js-field input[type=text]",function(e){13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),t(this).closest(".ps-js-fieldconf").find(".ps-js-save").click())}).find(".ps-js-field input[type=text]").each(function(){t(this).data("original-value",this.value)}),s.on("click",".ps-js-field .ps-js-cancel",function(){var e=t(this).closest(".ps-js-fieldconf"),s=e.find(".ps-js-btn"),a=e.find("input[type=text]");s.hide(),a.val(a.data("original-value")),a.tooltip("destroy")}),s.on("click",".ps-js-field .ps-js-save",function(){var e,s,a=t(this).closest(".ps-js-fieldconf"),i=a.find(".ps-js-btn"),o=a.find("input[type=text]"),n=a.find(".ps-js-progress");if(e="adminConfigFields.set_"+("meta"===o.data("prop-type")?"meta":"prop"),"validation"===(s={id:o.data("parent-id")||void 0,prop:o.data("prop-name")||void 0,key:o.data("prop-key")||void 0,value:o.val()}).prop){var d,l,p,r,c=s.key.match(/^[a-z]+(min|max)_value$/),f=!1;if(c&&(""===t.trim(s.value)||isNaN(s.value)||+s.value<0?f=peepsoadminprofilesdata.number_invalid:(p=s.key.replace(c[1],"min"===c[1]?"max":"min"),l=(d=a.closest(".ps-tab__content")).find('[data-prop-key="'+p+'"]'),d.find('[data-prop-key="'+p.replace("_value","")+'"]')[0].checked&&(r=l.data("original-value")||l.val(),"min"===c[1]&&+r<+s.value?f=(f=peepsoadminprofilesdata.min_invalid).replace(/%d/g,+r):"max"===c[1]&&+r>+s.value&&(f=(f=peepsoadminprofilesdata.max_invalid).replace(/%d/g,+r))))),f)return o.attr("title",f),o.addClass("tooltip-error"),void o.tooltip({placement:"left",trigger:"manual"}).tooltip("show");o.tooltip("destroy")}n.find("img").show(),o.attr("readonly","readonly"),$PeepSo.postJson(e,s,function(e){n.find("img").hide(),n.find("i").show().delay(800).fadeOut(),o.removeAttr("readonly"),e.success&&(i.hide(),o.data("original-value",s.value),"post_title"==o.data("prop-name")&&t("#field-"+s.id+"-box-title").html(s.value))})}),s.on("click","input[type=checkbox]",_.throttle(function(){var e,s,a=t(this),i=a.closest(".ps-js-fieldconf").find(".ps-js-progress"),o=a[0].checked,n=!1;if(e="adminConfigFields.set_"+("meta"===a.data("prop-type")?"meta":"prop"),s={id:a.data("parent-id")||void 0,prop:a.data("prop-name")||void 0,key:a.data("prop-key")||void 0,value:o?a.val():a.data("disabled-value")},o&&"validation"===s.prop){var d,l,p,r,c,f,u,v=s.key.match(/^[a-z]+(min|max)$/);v&&(f=s.key.replace(v[1],"min"===v[1]?"max":"min"),r=(d=a.closest(".ps-tab__content")).find('[data-prop-key="'+f+'"]'),c=d.find('[data-prop-key="'+f+'_value"]'),r[0].checked&&(u=c.data("original-value")||c.val(),"min"===v[1]&&+u<+s.value?n=!0:"max"===v[1]&&+u>+s.value&&(n=!0)),n&&(l=d.find('[data-prop-key="'+s.key+'_value"]'),p=l.nextAll(".ps-js-save"),l.val(u)))}i.find("i").stop().hide(),i.find("img").show(),a.attr("readonly","readonly"),$PeepSo.postJson(e,s,function(e){if(i.find("img").hide(),i.find("i").show().delay(800).fadeOut(),a.removeAttr("readonly"),e.success)if(n&&p.trigger("click"),$value_container_id="#"+a[0].id+"-value-container",$container_id="#"+a[0].id+"-container",o?t($value_container_id).fadeIn(500):t($value_container_id).fadeOut(500),"validation"===s.prop&&"required"===s.key){var d=t("#field-"+s.id+"-required-mark");o?d.removeClass("hidden"):d.addClass("hidden")}else"post_status"===s.prop&&(o?a.closest(".postbox").removeClass("postbox-muted"):a.closest(".postbox").addClass("postbox-muted"))})},1e3)),s.on("change","select",_.throttle(function(){var e,s,a=t(this),i=a.closest(".ps-js-fieldconf").find(".ps-js-progress");e="adminConfigFields.set_"+("meta"===a.data("prop-type")?"meta":"prop"),s={id:a.data("parent-id")||void 0,prop:a.data("prop-name")||void 0,key:a.data("prop-key")||void 0,value:a.val()},i.find("i").stop().hide(),i.find("img").show(),a.attr("readonly","readonly"),$PeepSo.postJson(e,s,function(t){i.find("img").hide(),i.find("i").show().delay(800).fadeOut(),a.removeAttr("readonly"),t.success})},1e3)),s.sortable({handle:".ps-js-handle",update:_.throttle(function(){var e=[];t(".ps-js-fields-container .postbox").each(function(){e.push(t(this).data("id"))}),$PeepSo.postJson("adminConfigFields.set_order",{fields:JSON.stringify(e)},function(t){})},3e3)}),s.on("click",".ps-js-field-toggle",function(){var e=t(this),s=e.closest(".postbox"),a=s.find(".ps-js-field"),o=s.data("id");a.is(":visible")?a.slideUp("fast",function(){e.removeClass("fa-compress").addClass("fa-expand"),i(),n(o,0)}):a.slideDown("fast",function(){e.removeClass("fa-expand").addClass("fa-compress"),i(),n(o,1)})}),s.on("click",".ps-js-field-title",function(e){e.target===e.currentTarget&&t(this).closest(".ps-postbox__title").find(".ps-js-field-toggle").click()}),s.on("mousedown",".ps-postbox__title",function(s){var a=t(s.currentTarget);e=setTimeout(function(){a.addClass("ps-js-mousedown")},200)}).on("mouseup mouseleave",".ps-postbox__title",function(s){clearTimeout(e),t(s.currentTarget).removeClass("ps-js-mousedown")}),t(".ps-js-field-expand-all").on("click",function(){s.find(".ps-js-field").slideDown("fast",function(){a(1)})}),t(".ps-js-field-collapse-all").on("click",function(){s.find(".ps-js-field").slideUp("fast",function(){a(0)})});var a=_.debounce(function(e){var s=t(".ps-js-fields-container").children(".postbox");0===e?s.find(".ps-js-field-toggle").removeClass("fa-compress").addClass("fa-expand"):s.find(".ps-js-field-toggle").removeClass("fa-expand").addClass("fa-compress"),i(e),n("all",e)},200);function i(e){var s,a,i=t(".ps-js-field-toggle-all"),o=i.find("span").first(),n=i.find("span").last();void 0===e&&(s=0,a=0,e=0,t(".ps-js-fields-container").find(".ps-js-field").each(function(){s++,t(this).is(":visible")&&a++}),a>=s&&(e=1)),0==+e?(i.data("status",0),n.html(i.data("expand-text")),o.removeClass("fa-compress").addClass("fa-expand")):(i.data("status",1),n.html(i.data("collapse-text")),o.removeClass("fa-expand").addClass("fa-compress"))}i();var o={},n=_.debounce(function(e,s){var a=[];"all"!==e?a=[e]:t(".ps-js-fields-container").children(".postbox").each(function(){a.push(t(this).data("id"))}),o[e]&&o[e].ret&&o[e].ret.abort(),o[e]=$PeepSo.postJson("adminConfigFields.set_admin_box_status",{id:JSON.stringify(a),status:s},function(t){})},500);t(".ps-js-field-new").on("click",function(){var e="no-plugin-warning",s=t("#"+e);if(!s.length){var a=window.peepsoadminprofilesdata||{};(s=t(a.popup_template)).prop("id",e),s.appendTo(document.body),s.on("click",".button-link",function(){s.hide()}),s.on("click",".button-primary",function(t){t.preventDefault(),t.stopPropagation(),s.hide(),window.open(a.plugin_url)})}s.show()}),s.on("click",".ps-tabs a",function(){var e=t(this),s=e.closest(".ps-tabs").find(".active");return s.removeClass("active"),e.addClass("active"),t(s.attr("href")).hide(),t(e.attr("href")).show(),!1}),s.on("click",".ps-postbox__title .fa-edit",function(){var e=t(this).closest(".ps-postbox__title"),s=e.find(".ps-postbox__title-label"),a=e.find(".ps-postbox__title-editor"),i=a.find("input[type=text]"),o=(i.nextAll(".ps-js-save"),i.data("prop-title-is-default")),n=i.val();s.hide(),a.show(),i.data("original-value",n).focus(),i.val(o?"":n).trigger("input")}),s.on("click",".ps-js-field-title-text",function(){t(this).closest(".ps-postbox__title").find(".fa-edit").click()}),s.on("click",".ps-postbox__title .ps-js-cancel",function(){var e=t(this).closest(".ps-postbox__title"),s=e.find(".ps-postbox__title-label"),a=e.find(".ps-postbox__title-editor"),i=a.find("input[type=text]");i.val(i.data("original-value")),a.hide(),s.show()}),s.on("click",".ps-postbox__title .ps-js-save",function(){var e,s,a=t(this).closest(".ps-postbox__title"),i=a.find(".ps-postbox__title-label"),o=a.find(".ps-postbox__title-editor"),n=o.find("input[type=text]"),d=a.find(".ps-js-progress");e="adminConfigFields.set_"+("meta"===n.data("prop-type")?"meta":"prop"),s={id:n.data("parent-id")||void 0,prop:n.data("prop-name")||void 0,key:n.data("prop-key")||void 0,value:n.val()},d.find("img").show(),n.attr("readonly","readonly"),$PeepSo.postJson(e,s,function(e){d.find("img").hide(),d.find("i").show().delay(800).fadeOut(),n.removeAttr("readonly"),e.success&&(o.hide(),i.show(),n.data("original-value",s.value),n.data("prop-title-is-default",!1),t("#field-"+s.id+"-box-title").html(s.value))})}),s.on("keydown",".ps-postbox__title input[type=text]",function(e){13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),t(this).nextAll(".ps-js-save").click())}).on("input",".ps-postbox__title input[type=text]",function(e){var s=t(this).nextAll(".ps-js-save");t.trim(this.value)?s.removeAttr("disabled"):s.attr("disabled","disabled")}),s.on("focus",".ps-js-focusguard",function(){var e=t(this),s=e.closest(".ps-js-options").children(".ps-js-fieldconf");"last"===e.data("tag")?s.find("input").first().focus():s.find("input").last().focus()}),s.on("change","select[data-prop-name=date_range_min]",function(e){var s=t(this),a=s.closest(".ps-tab__content").find("select[data-prop-name=date_range_max]");+a.val()<+s.val()&&a.val(s.val()).trigger("change")}),s.on("change","select[data-prop-name=date_range_max]",function(e){var s=t(this),a=s.closest(".ps-tab__content").find("select[data-prop-name=date_range_min]");+a.val()>+s.val()&&a.val(s.val()).trigger("change")}),t(function(){t(".ps-settings__bar").addClass("ps-settings__bar--static"),t(window).scroll(function(){var e=t(".ps-settings__bar");t(this).scrollTop()>50?e.removeClass("ps-settings__bar--static"):e.addClass("ps-settings__bar--static")})})}(jQuery);