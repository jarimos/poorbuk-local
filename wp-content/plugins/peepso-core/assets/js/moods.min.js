!function n(d,r,a){function c(t,o){if(!r[t]){if(!d[t]){var e="function"==typeof require&&require;if(!o&&e)return e(t,!0);if(h)return h(t,!0);var s=new Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}var i=r[t]={exports:{}};d[t][0].call(i.exports,function(o){return c(d[t][1][o]||o)},i,i.exports,n,d,r,a)}return r[t].exports}for(var h="function"==typeof require&&require,o=0;o<a.length;o++)c(a[o]);return c}({1:[function(o,t,e){"use strict";var s;s=function(n){var e=n("#mood-text-string").text(),d=!1,t=".ps-postbox-moods";function o(){this.__constructor.apply(this,arguments)}return o.prototype={__constructor:function(o){this.postbox=o,this.$doc=n(document),this.$toggle=o.$tabContext.find("#mood-tab"),this.$dropdown=o.$tabContext.find(".ps-js-postbox-mood"),this.$remove=this.$dropdown.find("button"),this.$toggle.on("click"+t,n.proxy(this.toggle,this)),this.$dropdown.on("click"+t,".mood-list",n.proxy(this.select,this)),this.$remove.on("click"+t,n.proxy(this.remove,this)),this._mapMoods(),o.add_action("update",this.update,10,2,this),o.add_filter("render_addons",this.render,10,1,this),o.add_filter("data",this.filterData,10,1,this),o.add_filter("data_validate",this.validate,10,2,this)},show:function(){this.$dropdown.show(),this.$doc.on("click"+t,n.proxy(this.onDocumentClick,this))},hide:function(){this.$dropdown.hide(),this.$doc.off("click"+t)},toggle:function(){this.$dropdown.is(":visible")?this.hide():this.show()},filterData:function(o){return this._selected?o.mood=this._selected.value:o.mood="",o},validate:function(o,t){return!!this._selected||o},select:function(o){var t=n(o.currentTarget);t.length&&(this._selected={value:t.data("option-value"),label:t.data("option-display-value"),className:t.find("i").attr("class")},this.$toggle.addClass("active"),this.$remove.show(),this.postbox.do_action("refresh"))},remove:function(){this._selected=!1,this.$toggle.removeClass("active"),this.$remove.hide(),this.postbox.do_action("refresh")},update:function(o){(o=o&&o.data||{}).mood?(this._selected={value:o.mood,label:d[o.mood].label,className:d[o.mood].icon},this.$toggle.addClass("active"),this.$remove.show()):(this._selected=!1,this.$toggle.removeClass("active"),this.$remove.hide()),this.postbox.do_action("refresh")},render:function(o){var t;return this._selected&&(t='<i class="'+this._selected.className+'"></i>',t+="<b> "+e+this._selected.label+"</b>",o.push(t)),o},_mapMoods:function(){d||this.$dropdown.find("a.mood-list").each(function(){var o=n(this),t=o.find("i"),e=o.data("option-value"),s=o.data("option-display-value"),i=t.attr("class");d||(d={}),d[e]={icon:i,label:s}})},onDocumentClick:function(o){n(o.target).closest(this.$toggle).length||this.hide()}},o}(jQuery),ps_observer.add_action("postbox_init",function(o){new s(o)},10,1),jQuery||$,peepso,function(o,t){function e(){this.$postbox=null,this.$mood=null,this.$mood_remove=null,this.$mood_dropdown_toggle=null,this.mood_selected=!1,this.can_submit=!1}e.prototype.set_postbox=function(o){this.$postbox=o},e.prototype.init=function(){if(!_.isUndefined(this.$postbox)){var s=this;ps_observer.add_filter("peepso_postbox_can_submit",function(o){return o.soft.push(s.can_submit),o},20,1),this.$mood=jQuery("#postbox-mood",this.$postbox),this.$mood_dropdown_toggle=jQuery("#mood-tab .interaction-icon-wrapper > a",this.$postbox),this.$mood_remove=jQuery("#postbox-mood-remove",this.$postbox),this.$mood.on("click","a.mood-list",function(o){s.select_mood(o)}),this.$mood_remove.on("click",function(){s.remove_mood()}),this.$mood_dropdown_toggle.on("click",function(){s.$mood.toggle()}),this.$mood_dropdown_toggle.on("peepso.interaction-hide",function(){s.$mood.hide()}),jQuery(document).on("click",function(o){var t=jQuery("#mood-tab",s.$postbox);t.is(o.target)||0!==t.has(o.target).length||s.$mood.hide()}),this.$postbox.on("postbox.post_cancel postbox.post_saved",function(){s.remove_mood()}),ps_observer.add_filter("postbox_req_"+this.$postbox.guid,function(o){return s.set_mood(o)},10,1),ps_observer.add_filter("peepso_postbox_addons_update",function(o){var t,e;return s.mood_selected&&(t=s.mood_selected,e='<i class="ps-emoticon '+t[0]+'"></i> <b>'+t[1]+"</b>",o.push(e)),o},10,1)}},e.prototype.select_mood=function(o){var t=jQuery(o.target).closest("a"),e=jQuery("#mood-tab",this.$postbox),s=jQuery("#postbox-mood-input",this.$postbox),i=(e.find("a"),t.closest("#postbox-mood")),n=(this.$postbox.$textarea.parent(),t.find("i").attr("class")),d=jQuery("#mood-text-string").text()+t.attr("data-option-display-value");s.val(t.attr("data-option-value")),this.$mood_remove.show(),i.hide(),e.addClass("active"),this.mood_selected=[n,d],this.can_submit=!0,this.$postbox.on_change()},e.prototype.remove_mood=function(){jQuery("span#postmood",this.$postbox.$textarea.parent()).remove(),jQuery("#postbox-mood-input",this.$postbox).val("");var o=jQuery("#mood-tab",this.$postbox);o.removeClass("active"),this.$mood_remove.hide(),this.$mood.hide(),this.mood_selected=!1,this.can_submit=!1,this.$postbox.on_change()},e.prototype.set_mood=function(o){return void 0===o.mood&&(o.mood=""),o.mood=jQuery("#postbox-mood-input",this.$postbox).val(),o},ps_observer.add_filter("peepso_postbox_addons",function(o){return o.push(new e),o},10,1)}()},{}]},{},[1]);